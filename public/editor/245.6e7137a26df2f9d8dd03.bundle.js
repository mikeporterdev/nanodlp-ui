"use strict";(self.webpackChunknanosupport=self.webpackChunknanosupport||[]).push([[245],{8245:(t,e,r)=>{r.r(e),r.d(e,{VTKLoader:()=>a});var n=r(7749),s=r(6488);class a extends n.Loader{constructor(t){super(t)}load(t,e,r,s){const a=this,o=new n.FileLoader(a.manager);o.setPath(a.path),o.setResponseType("arraybuffer"),o.setRequestHeader(a.requestHeader),o.setWithCredentials(a.withCredentials),o.load(t,(function(r){try{e(a.parse(r))}catch(e){s?s(e):console.error(e),a.manager.itemError(t)}}),r,s)}parse(t){function e(t,e){const r=t.length,n=new Float32Array(r+e.length);return n.set(t),n.set(e,r),n}function r(t,e){const r=t.length,n=new Int32Array(r+e.length);return n.set(t),n.set(e,r),n}const a=n.LoaderUtils.decodeText(new Uint8Array(t,0,250)).split("\n");return-1!==a[0].indexOf("xml")?function(t){function a(t){const e="undefined"!=typeof Uint8Array?Uint8Array:Array,r=[],n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(let t=0,e=n.length;t<e;++t)r[n.charCodeAt(t)]=t;r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63;const s=t.length;if(s%4>0)throw new Error("Invalid string. Length must be a multiple of 4");const a="="===t[s-2]?2:"="===t[s-1]?1:0,o=new e(3*s/4-a),l=a>0?s-4:s;let i,u,f=0;for(i=0,u=0;i<l;i+=4,u+=3){const e=r[t.charCodeAt(i)]<<18|r[t.charCodeAt(i+1)]<<12|r[t.charCodeAt(i+2)]<<6|r[t.charCodeAt(i+3)];o[f++]=(16711680&e)>>16,o[f++]=(65280&e)>>8,o[f++]=255&e}if(2===a){const e=r[t.charCodeAt(i)]<<2|r[t.charCodeAt(i+1)]>>4;o[f++]=255&e}else if(1===a){const e=r[t.charCodeAt(i)]<<10|r[t.charCodeAt(i+1)]<<4|r[t.charCodeAt(i+2)]>>2;o[f++]=e>>8&255,o[f++]=255&e}return o}function o(t,n){let o,i,u=0;if("UInt64"===l.attributes.header_type?u=8:"UInt32"===l.attributes.header_type&&(u=4),"binary"===t.attributes.format&&n){"Float32"===t.attributes.type?o=new Float32Array:"Int32"!==t.attributes.type&&"Int64"!==t.attributes.type||(o=new Int32Array);const n=t["#text"],l=a(Array.isArray(n)?n[0]:n),f=8;let c=l[0];for(let t=1;t<u-1;t++)c|=l[t]<<t*f;let p=(c+3)*u;p+=p%3>0?3-p%3:0;const A=[];let d=p;A.push(d);const h=3*u;for(let t=0;t<c;t++){let e=l[t*u+h];for(let r=1;r<u-1;r++)e|=l[t*u+h+r]<<r*f;d+=e,A.push(d)}for(let n=0;n<A.length-1;n++)i=s.unzlibSync(l.slice(A[n],A[n+1])).buffer,"Float32"===t.attributes.type?(i=new Float32Array(i),o=e(o,i)):"Int32"!==t.attributes.type&&"Int64"!==t.attributes.type||(i=new Int32Array(i),o=r(o,i));delete t["#text"],"Int64"===t.attributes.type&&"binary"===t.attributes.format&&(o=o.filter((function(t,e){if(e%2!=1)return!0})))}else"binary"!==t.attributes.format||n?i=t["#text"]?t["#text"].split(/\s+/).filter((function(t){if(""!==t)return t})):new Int32Array(0).buffer:(i=a(t["#text"]),i=i.slice(u).buffer),delete t["#text"],"Float32"===t.attributes.type?o=new Float32Array(i):"Int32"===t.attributes.type?o=new Int32Array(i):"Int64"===t.attributes.type&&(o=new Int32Array(i),"binary"===t.attributes.format&&(o=o.filter((function(t,e){if(e%2!=1)return!0}))));return o}const l=function t(e){let r={};if(1===e.nodeType){if(e.attributes&&e.attributes.length>0){r.attributes={};for(let t=0;t<e.attributes.length;t++){const n=e.attributes.item(t);r.attributes[n.nodeName]=n.nodeValue.trim()}}}else 3===e.nodeType&&(r=e.nodeValue.trim());if(e.hasChildNodes())for(let n=0;n<e.childNodes.length;n++){const s=e.childNodes.item(n),a=s.nodeName;if(void 0===r[a]){const e=t(s);""!==e&&(r[a]=e)}else{if(void 0===r[a].push){const t=r[a];r[a]=[t]}const e=t(s);""!==e&&r[a].push(e)}}return r}((new DOMParser).parseFromString(t,"application/xml").documentElement);let i=[],u=[],f=[];if(l.PolyData){const t=l.PolyData.Piece,e=l.attributes.hasOwnProperty("compressor"),r=["PointData","Points","Strips","Polys"];let s=0;const a=r.length;for(;s<a;){const n=t[r[s]];if(n&&n.DataArray){let a;a=Array.isArray(n.DataArray)?n.DataArray:[n.DataArray];let l=0;const c=a.length;for(;l<c;)"#text"in a[l]&&a[l]["#text"].length>0&&(a[l].text=o(a[l],e)),l++;switch(r[s]){case"PointData":{const e=parseInt(t.attributes.NumberOfPoints),r=n.attributes.Normals;if(e>0)for(let t=0,n=a.length;t<n;t++)if(r===a[t].attributes.Name){const r=a[t].attributes.NumberOfComponents;u=new Float32Array(e*r),u.set(a[t].text,0)}}break;case"Points":{const e=parseInt(t.attributes.NumberOfPoints);if(e>0){const t=n.DataArray.attributes.NumberOfComponents;i=new Float32Array(e*t),i.set(n.DataArray.text,0)}}break;case"Strips":{const e=parseInt(t.attributes.NumberOfStrips);if(e>0){const t=new Int32Array(n.DataArray[0].text.length),r=new Int32Array(n.DataArray[1].text.length);t.set(n.DataArray[0].text,0),r.set(n.DataArray[1].text,0);const s=e+t.length;f=new Uint32Array(3*s-9*e);let a=0;for(let n=0,s=e;n<s;n++){const e=[];for(let s=0,a=r[n],o=0;s<a-o;s++)e.push(t[s]),n>0&&(o=r[n-1]);for(let t=0,s=r[n],o=0;t<s-o-2;t++)t%2?(f[a++]=e[t],f[a++]=e[t+2],f[a++]=e[t+1]):(f[a++]=e[t],f[a++]=e[t+1],f[a++]=e[t+2]),n>0&&(o=r[n-1])}}}break;case"Polys":{const e=parseInt(t.attributes.NumberOfPolys);if(e>0){const t=new Int32Array(n.DataArray[0].text.length),r=new Int32Array(n.DataArray[1].text.length);t.set(n.DataArray[0].text,0),r.set(n.DataArray[1].text,0);const s=e+t.length;f=new Uint32Array(3*s-9*e);let a=0,o=0,l=0,i=0;const u=e;for(;l<u;){const e=[];let n=0;const s=r[l];for(;n<s-i;)e.push(t[o++]),n++;let u=1;for(;u<s-i-1;)f[a++]=e[0],f[a++]=e[u],f[a++]=e[u+1],u++;l++,i=r[l-1]}}}}}s++}const c=new n.BufferGeometry;return c.setIndex(new n.BufferAttribute(f,1)),c.setAttribute("position",new n.BufferAttribute(i,3)),u.length===i.length&&c.setAttribute("normal",new n.BufferAttribute(u,3)),c}throw new Error("Unsupported DATASET type")}(n.LoaderUtils.decodeText(t)):a[2].includes("ASCII")?function(t){const e=[],r=[],s=[],a=[];let o;const l=/^[^\d.\s-]+/,i=/(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)\s+(\-?\d+\.?[\d\-\+e]*)/g,u=/^(\d+)\s+([\s\d]*)/,f=/^POINTS /,c=/^POLYGONS /,p=/^TRIANGLE_STRIPS /,A=/^POINT_DATA[ ]+(\d+)/,d=/^CELL_DATA[ ]+(\d+)/,h=/^COLOR_SCALARS[ ]+(\w+)[ ]+3/,y=/^NORMALS[ ]+(\w+)[ ]+(\w+)/;let b=!1,x=!1,I=!1,w=!1,g=!1,m=!1,F=!1;const D=t.split("\n");for(const t in D){const n=D[t].trim();if(0===n.indexOf("DATASET")){const t=n.split(" ")[1];if("POLYDATA"!==t)throw new Error("Unsupported DATASET type: "+t)}else if(b)for(;null!==(o=i.exec(n))&&null===l.exec(n);){const t=parseFloat(o[1]),e=parseFloat(o[2]),n=parseFloat(o[3]);r.push(t,e,n)}else if(x){if(null!==(o=u.exec(n))){const t=parseInt(o[1]),r=o[2].split(/\s+/);if(t>=3){const n=parseInt(r[0]);let s=1;for(let a=0;a<t-2;++a){const t=parseInt(r[s]),a=parseInt(r[s+1]);e.push(n,t,a),s++}}}}else if(I){if(null!==(o=u.exec(n))){const t=parseInt(o[1]),r=o[2].split(/\s+/);if(t>=3)for(let n=0;n<t-2;n++)if(n%2==1){const t=parseInt(r[n]),s=parseInt(r[n+2]),a=parseInt(r[n+1]);e.push(t,s,a)}else{const t=parseInt(r[n]),s=parseInt(r[n+1]),a=parseInt(r[n+2]);e.push(t,s,a)}}}else if(w||g)if(m)for(;null!==(o=i.exec(n))&&null===l.exec(n);){const t=parseFloat(o[1]),e=parseFloat(o[2]),r=parseFloat(o[3]);s.push(t,e,r)}else if(F)for(;null!==(o=i.exec(n))&&null===l.exec(n);){const t=parseFloat(o[1]),e=parseFloat(o[2]),r=parseFloat(o[3]);a.push(t,e,r)}null!==c.exec(n)?(x=!0,b=!1,I=!1):null!==f.exec(n)?(x=!1,b=!0,I=!1):null!==p.exec(n)?(x=!1,b=!1,I=!0):null!==A.exec(n)?(w=!0,b=!1,x=!1,I=!1):null!==d.exec(n)?(g=!0,b=!1,x=!1,I=!1):null!==h.exec(n)?(m=!0,F=!1,b=!1,x=!1,I=!1):null!==y.exec(n)&&(F=!0,m=!1,b=!1,x=!1,I=!1)}let T=new n.BufferGeometry;if(T.setIndex(e),T.setAttribute("position",new n.Float32BufferAttribute(r,3)),a.length===r.length&&T.setAttribute("normal",new n.Float32BufferAttribute(a,3)),s.length!==e.length)s.length===r.length&&T.setAttribute("color",new n.Float32BufferAttribute(s,3));else{T=T.toNonIndexed();const t=T.attributes.position.count/3;if(s.length===3*t){const e=[];for(let r=0;r<t;r++){const t=s[3*r+0],n=s[3*r+1],a=s[3*r+2];e.push(t,n,a),e.push(t,n,a),e.push(t,n,a)}T.setAttribute("color",new n.Float32BufferAttribute(e,3))}}return T}(n.LoaderUtils.decodeText(t)):function(t){const e=new Uint8Array(t),r=new DataView(t);let s,a,o=[],l=[],i=[],u=0;function f(t,e){let r=e,n=t[r];const s=[];for(;10!==n;)s.push(String.fromCharCode(n)),r++,n=t[r];return{start:e,end:r,next:r+1,parsedString:s.join("")}}for(;;){if(s=f(e,u),a=s.parsedString,0===a.indexOf("DATASET")){const t=a.split(" ")[1];if("POLYDATA"!==t)throw new Error("Unsupported DATASET type: "+t)}else if(0===a.indexOf("POINTS")){const t=parseInt(a.split(" ")[1],10),e=4*t*3;o=new Float32Array(3*t);let n=s.next;for(let e=0;e<t;e++)o[3*e]=r.getFloat32(n,!1),o[3*e+1]=r.getFloat32(n+4,!1),o[3*e+2]=r.getFloat32(n+8,!1),n+=12;s.next=s.next+e+1}else if(0===a.indexOf("TRIANGLE_STRIPS")){const t=parseInt(a.split(" ")[1],10),e=parseInt(a.split(" ")[2],10),n=4*e;i=new Uint32Array(3*e-9*t);let o=0,l=s.next;for(let e=0;e<t;e++){const t=r.getInt32(l,!1),e=[];l+=4;for(let n=0;n<t;n++)e.push(r.getInt32(l,!1)),l+=4;for(let r=0;r<t-2;r++)r%2?(i[o++]=e[r],i[o++]=e[r+2],i[o++]=e[r+1]):(i[o++]=e[r],i[o++]=e[r+1],i[o++]=e[r+2])}s.next=s.next+n+1}else if(0===a.indexOf("POLYGONS")){const t=parseInt(a.split(" ")[1],10),e=parseInt(a.split(" ")[2],10),n=4*e;i=new Uint32Array(3*e-9*t);let o=0,l=s.next;for(let e=0;e<t;e++){const t=r.getInt32(l,!1),e=[];l+=4;for(let n=0;n<t;n++)e.push(r.getInt32(l,!1)),l+=4;for(let r=1;r<t-1;r++)i[o++]=e[0],i[o++]=e[r],i[o++]=e[r+1]}s.next=s.next+n+1}else if(0===a.indexOf("POINT_DATA")){const t=parseInt(a.split(" ")[1],10);s=f(e,s.next);const n=4*t*3;l=new Float32Array(3*t);let o=s.next;for(let e=0;e<t;e++)l[3*e]=r.getFloat32(o,!1),l[3*e+1]=r.getFloat32(o+4,!1),l[3*e+2]=r.getFloat32(o+8,!1),o+=12;s.next=s.next+n}if(u=s.next,u>=e.byteLength)break}const c=new n.BufferGeometry;return c.setIndex(new n.BufferAttribute(i,1)),c.setAttribute("position",new n.BufferAttribute(o,3)),l.length===o.length&&c.setAttribute("normal",new n.BufferAttribute(l,3)),c}(t)}}}}]);